<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StellarBooks - Inicio</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/site.css">
    <link rel="stylesheet" href="css/home.css">
</head>
<body>
    <!-- Header -->
    <header class="header-bg">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-5 fw-bold mb-0">
                        <i class="bi bi-book-half"></i> StellarBooks
                    </h1>
                    <p class="lead mb-0">Biblioteca de Cuentos Infantiles</p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="mb-2">
                        <span id="currentDate" class="text-white-50 d-block"></span>
                    </div>
                    <div class="d-flex gap-2 justify-content-end">
                        <button id="homeBtn" class="btn-nav-home">
                            <i class="bi bi-house-door"></i> Inicio
                        </button>
                        <button id="indexBtn" class="btn-nav-admin">
                            <i class="bi bi-gear"></i> Administrar
                        </button>
                        <button id="logoutBtn" class="btn-danger ms-2">
                            <i class="bi bi-box-arrow-right"></i> Salir
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Welcome Section -->
    <section class="welcome-section py-5">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h2 class="display-6 text-gradient mb-3">¡Bienvenidos al mundo de los cuentos!</h2>
                    <p class="lead welcome-desc">Descubre historias increíbles y actividades divertidas</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Navigation Tabs -->
    <div class="container">
        <ul class="nav nav-tabs" id="homeTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="stories-tab" data-bs-toggle="tab" data-bs-target="#stories" type="button" role="tab">
                    <i class="bi bi-book"></i> Cuentos
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="home-activities-tab" data-bs-toggle="tab" data-bs-target="#home-activities" type="button" role="tab">
                    <i class="bi bi-puzzle"></i> Actividades
                </button>
            </li>
        </ul>
    </div>

    <!-- Tab Content -->
    <div class="container mt-4">
        <div class="tab-content" id="homeTabsContent">
            
            <!-- Stories Tab -->
            <div class="tab-pane fade show active" id="stories" role="tabpanel" aria-labelledby="stories-tab">
                
                <!-- Filters -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label for="storyThemeFilter" class="form-label">Tema</label>
                                <select class="form-select" id="storyThemeFilter">
                                    <option value="">Todos los temas</option>
                                    <option value="Fantasía">Fantasía</option>
                                    <option value="Aventura">Aventura</option>
                                    <option value="Educativo">Educativo</option>
                                    <option value="Comedia">Comedia</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="storyAgeFilter" class="form-label">Edad</label>
                                <select class="form-select" id="storyAgeFilter">
                                    <option value="">Todas las edades</option>
                                    <option value="1-3">1-3 años</option>
                                    <option value="4-6">4-6 años</option>
                                    <option value="7-9">7-9 años</option>
                                    <option value="10-12">10-12 años</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="storySortBy" class="form-label">Ordenar por</label>
                                <select class="form-select" id="storySortBy">
                                    <option value="title">Título (A-Z)</option>
                                    <option value="title_desc">Título (Z-A)</option>
                                    <option value="age">Edad (menor a mayor)</option>
                                    <option value="age_desc">Edad (mayor a menor)</option>
                                </select>
                            </div>
                            <div class="col-md-3 d-flex align-items-end">
                                <button type="button" class="btn btn-outline-secondary w-100" id="clearStoryFilters">
                                    <i class="bi bi-x-circle me-1"></i> Limpiar filtros
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stories Grid -->
                <div id="storiesGrid" class="row g-4">
                    <!-- Stories will be loaded dynamically -->
                </div>

                <!-- Empty State -->
                <div class="empty-state text-center d-none" id="emptyStoriesState">
                    <i class="bi bi-book fs-1 mb-2 text-white"></i>
                    <h4>No hay cuentos disponibles</h4>
                    <p class="text-white">No se encontraron cuentos que coincidan con los filtros seleccionados.</p>
                </div>
            </div>

            <!-- Activities Tab -->
            <div class="tab-pane fade" id="home-activities" role="tabpanel" aria-labelledby="home-activities-tab">
                
                <!-- Activities Filter -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label for="activityStoryFilter" class="form-label">Cuento</label>
                                <select class="form-select" id="activityStoryFilter">
                                    <option value="">Todos los cuentos</option>
                                    <!-- Options will be loaded dynamically -->
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="homeActivityTypeFilter" class="form-label">Tipo</label>
                                <select class="form-select" id="homeActivityTypeFilter">
                                    <option value="">Todos los tipos</option>
                                    <option value="DotToDot">DotToDot</option>
                                    <option value="Drawing">Drawing</option>
                                    <option value="Quiz">Quiz</option>
                                </select>
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <button type="button" class="btn btn-outline-secondary w-100" id="clearActivityFilters">
                                    <i class="bi bi-x-circle me-1"></i> Limpiar filtros
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Activities Grid -->
                <div id="activitiesGrid" class="row g-4">
                    <!-- Activities will be loaded dynamically -->
                </div>

                <!-- Empty State -->
                <div class="empty-state text-center d-none" id="emptyActivitiesState">
                    <i class="bi bi-puzzle fs-1 mb-2 text-withe"></i>
                    <h4>No hay actividades disponibles</h4>
                    <p class="text-white">No se encontraron actividades que coincidan con los filtros seleccionados.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Story Reader Modal -->
    <div class="modal fade" id="storyReaderModal" tabindex="-1" aria-labelledby="storyReaderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="storyReaderModalLabel">
                        <i class="bi bi-book-open me-2"></i>
                        <span id="storyReaderTitle">Cuento</span>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body story-reader">
                    <div class="row">
                        <div class="col-md-6">
                            <img id="storyReaderImage" src="" alt="Imagen del cuento" class="img-fluid rounded">
                        </div>
                        <div class="col-md-6">
                            <div class="story-info mb-3">
                                <p><strong>Tema:</strong> <span id="storyReaderTheme"></span></p>
                                <p><strong>Edad recomendada:</strong> <span id="storyReaderAge"></span> años</p>
                            </div>
                            <div class="favorite-section">
                                <button type="button" class="btn btn-outline-danger" id="addToFavoritesBtn">
                                    <i class="bi bi-heart me-1"></i> Agregar a Favoritos
                                </button>
                            </div>
                            <div class="audio-player mb-3">
                                <label class="form-label"><strong>Audio narración:</strong></label>
                                <audio id="storyAudioPlayer" controls class="w-100" preload="none">
                                    Tu navegador no soporta audio.
                                </audio>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="story-content">
                        <h6><strong>Contenido del cuento:</strong></h6>
                        <div id="storyReaderContent" class="story-text"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Activity Player Modal -->
    <div class="modal fade" id="activityPlayerModal" tabindex="-1" aria-labelledby="activityPlayerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="activityPlayerModalLabel">
                        <i class="bi bi-puzzle me-2"></i>
                        <span id="activityPlayerTitle">Actividad</span>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body activity-player">
                    <div class="row">
                        <div class="col-12">
                            <div class="activity-info mb-3">
                                <p><strong>Cuento:</strong> <span id="activityPlayerStory"></span></p>
                                <p><strong>Tipo:</strong> <span id="activityPlayerType"></span></p>
                                <p><strong>Descripción:</strong> <span id="activityPlayerDescription"></span></p>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="activity-content text-center">
                        <div id="activityPlayerContent">
                            <!-- Activity content will be loaded here -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay d-none">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Cargando...</span>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/logout.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="js/home.js"></script>
</body>
</html>